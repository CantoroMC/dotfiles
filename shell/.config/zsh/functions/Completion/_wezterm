#compdef wezterm

local curcontext="$curcontext" state line ret=1

_arguments \
  -C -A "-V" -A "--version" -A "-h" -A "--help" -C "-n"\
	'(- 1 *)'{-V,--version}'[display version information]'\
  {-h,--help}'[Prints help information]' \
  '-n[Skip loading wezterm.lua]' \
  '1: :->cmds'\
	'*:: :->args' && ret=0

case $state in
  cmds)
    _values "wezterm command" \
    "cli[Interact with experimental mux server]" \
    "connect[Connect to wezterm multiplexer]" \
    "help[Prints this message or the help of the given subcommand(s)]" \
    "imgcat[Output an image to the terminal]" \
    "ls-fonts[Display information about fonts]" \
    "serial[Open a serial port]" \
    "set-working-directory[Advice the terminal of the current working directory by emitting an OSC 7 escape]" \
    "ssh[Establish an ssh session]" \
    "start[Start a front-end]"
    ret=0
    ;;
  args)
    case $line[1] in
      help)
        _values 'cli' 'connect' 'imgcat' 'ls-fonts' 'serial' 'set-working-directory' 'ssh' 'start' && ret=0
        ;;
      imgcat)
        _arguments \
          '(--no-preserver-aspect-ratio)--no-preserve-aspect-ratio[Do not respect the aspect ratio]' \
          '(--height)--height[Specify the display height]' \
          '(--width)--width[Specify the dispaly width]' \
          '*:Image file:_files -g "*.(png|jpg|jpeg)(-.)"' && ret=0
        ;;
      serial)
        _arguments \
          '(*--baud)--baud[Set the baud rate]' && ret=0
        ;;
      ssh)
        _arguments \
          '(-o)-o[Override specific SSH configuration options]'\
          '(--ssh-option)--ssh-option[Override specific SSH configuration options]'\
          ':hosts:_hosts' && ret=0
        ;;
      start)
        _arguments \
          '(--class)--class[Override the default windowing system class]'\
          '(--cwd)--cwd[Specify the current working directory for the initially spawned program]:directory:_dirs'\
          ':command:_path_commands' && ret=0
          ;;
    esac
esac

return ret
